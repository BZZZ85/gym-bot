services:
  - type: worker
    name: telegram-bot
    build:
      env:
        PYTHON_VERSION: 3.12.7
      buildCommand: |
        # Обновляем pip и необходимые инструменты
        pip install --upgrade pip setuptools wheel maturin

        # Устанавливаем pydantic и pydantic-core только бинарными колёсами
        pip install --only-binary :all: pydantic-core pydantic==2.8.2

        # Устанавливаем остальные зависимости
        pip install -r requirements.txt
    startCommand: python bot_mvp.py
    autoDeploy: true
    envVars:
      - key: DATABASE_URL
        value: postgresql://neondb_owner:npg_0eRPsTi9tJAj@ep-winter-snow-ab9o1qut-pooler.eu-west-2.aws.neon.tech/neondb?sslmode=require
      - key: BOT_TOKEN
        sync: false
